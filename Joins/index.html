
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../select_by_att/">
      
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>Joins - Intro to GIS Survival Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#joins-with-linknyc-kiosk-locations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Intro to GIS Survival Guide" class="md-header__button md-logo" aria-label="Intro to GIS Survival Guide" data-md-component="logo">
      
  <img src="../img/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Intro to GIS Survival Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Joins
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Intro to GIS Survival Guide" class="md-nav__button md-logo" aria-label="Intro to GIS Survival Guide" data-md-component="logo">
      
  <img src="../img/favicon.png" alt="logo">

    </a>
    Intro to GIS Survival Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../apporto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing GIS outside of class
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../common_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Errors
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../symbolizing_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symbolizing Data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../project_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Tool
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPX Data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calculating_fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calculating Fields
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../select_by_att/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Select by Attribute
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Joins
    
  </span>
  

      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="joins-with-linknyc-kiosk-locations">Joins with LinkNYC kiosk locations.</h1>
<p>We will examine how we can get a count of link kiosks per zip code - with either a tabular of spatial join. All of this data used here can be found in the Link NYC folder in brightspace.</p>
<h1 id="tabular-joins">Tabular Joins</h1>
<p>Remember for tabular joins, we want each geographic identifier, (census tract id, zip code, etc.) to only appear in our data once. This is because the software will automatically join the data from the first time it finds a match - so if your data is not aggregated, your join will run without error, but will be completely wrong.</p>
<h1 id="for-example-in-this-link-dataset-in-the-raw-form-we-see-each-zip-code-appears-more-than-once-this-makes-sense-as-this-data-is-the-location-of-each-kiosk-and-we-can-assume-there-are-zip-codes-that-contain-more-than-one">For example in this Link dataset in the raw form, we see each zip code appears more than once. This makes sense, as this data is the location of each kiosk, and we can assume there are zip codes that contain more than one.</h1>
<p><img alt="Data Duplicates" src="../img/data_doubles.png" /></p>
<p>But, to use this data in a tabular join, we need to use it as structured in the zip_counts.csv, already aggregated by count. Now, there are a few ways we can get the data in this format if it wasn't already structured this way. </p>
<h2 id="1-pivot-table">1. Pivot Table</h2>
<p>If you are familiar with Excel, you can preprocess the data with a Pivot table. In this case, we are grouping by the zip field, with a count of each time it appears in the dataset. </p>
<p>First you will highlight the entire range of data, and navigate to Insert &gt; Pivot Table</p>
<p><img alt="Pivot" src="../img/pivot_table.png" /></p>
<p>Select Table/Range and then accept the highlighted range.</p>
<p><img alt="Table Range" src="../img/table_range.png" /></p>
<p>From the Pivot Table menu, Select the Postcode field (Zip) for Row field, and the Count of Postcode for the Value field.</p>
<p><img alt="Pivot Post" src="../img/pivot_post.png" /></p>
<p>Then you could copy this data into a separate csv, and pull into GIS.</p>
<h2 id="2-within-pro">2. Within Pro</h2>
<p>We can also use the Summary Statistics tool to aggregate our data in a format that it could be used in a tabular join. </p>
<p>To do so, we would pull the unaggregated data in Pro as a csv, and then export as a Table object.</p>
<p><img alt="Link Table" src="../img/link_table.png" /></p>
<p>The from the attribute table, we can right-click on the Postcode field and select summarize, and fill out the fields to get a count of each time zip appears. Think about how if we wanted to aggregate on a different geographic field in the data we could select that, or a different aggregation method such as sum or average.</p>
<p><img alt="Zip Count" src="../img/postcode_sum_stats.png" /></p>
<p>Then we would similarly have a table with a count of each time a zip code appears in our data.</p>
<p><img alt="Zip Count 2" src="../img/zip_count.png" /></p>
<h2 id="3-with-python-in-google-colab-using-groupby">3. With Python in Google Colab (Using Groupby)</h2>
<p>You can also review the exploring lodes and lab 6 processing notebook files for more groupby examples. But if you were starting from scratch, you would navigate to www.colab.researh.google.com, and open a new notebook.</p>
<p>Remember our first step is to import the packages we will need. For this operation, we will just need to import the pandas library.</p>
<p>import pandas as pd</p>
<p><img alt="Pandas" src="../img/pandas.png" /></p>
<p>Then, we need to get our data into the notebook. Remember Google Colab has a unique way of doing this. The syntax is:</p>
<p>from google.colab import files
uploaded = files.upload()</p>
<p>This will open a dialog where you can navigate to the unaggregated link kiosk data.</p>
<p><img alt="File Import" src="../img/file_import.png" /></p>
<p>Now we will convert the raw csv we imported into the Colab environment into a pandas dataframe. The syntax is:</p>
<p>unaggregated_link = pd.read_csv('LinkNYC_Map.csv')</p>
<p>Now, all we need to do is run a groupby operation that groups by Postcode, and aggregates them as a count. They syntax is:</p>
<p>aggregated_link = unaggregated_link.groupby('Postcode').size()</p>
<p>And then we can similarly export our csv out with the colab option. The syntax is:</p>
<p>from google.colab import files
aggregated_link.to_csv('aggregated_link.csv', index=False)
files.download('aggregated_link.csv')</p>
<p>And then we can do the join on that file in Pro. If you want the link to this entire notebook it is here: <a href="https://colab.research.google.com/drive/1N8LhML2YOJSUBGxKP-OXjouxMUlJ6eWV?usp=sharing">link</a></p>
<h2 id="luckily-i-had-already-aggregated-the-data-for-you-in-the-csv-zip_countscsv">Luckily, I had already aggregated the data for you in the csv, zip_counts.csv</h2>
<p>So however we aggregated our data - now we can do the tabular join.</p>
<p>First we pull in our spatial file and csv into a new project. In this scenario the geography would be the zip code shapefile, because that is the level our data is aggregated at.</p>
<p><img alt="Zip Prep" src="../img/zip_prep.png" /></p>
<p>Then we should export both our csv and shapefile to the geodatabase, so we are dealing with a table and feature class.</p>
<p>The two main things we need for a tabular join are a shared field and for that field to be stored in the same data type. In our spatial file this is ZIPCODE, which is stored as text, and in our table this is zip, which is stored as Long. We will create a new text field in our tabular data, populate with the values of 'zip' and then complete the merge. </p>
<p>First within the fields menu we will create a new field and call it something like zip_text. Make sure you set the data type to text. </p>
<p><img alt="New Field" src="../img/new_field.png" /></p>
<p>When we have our empty field, we will right-click and select Calculate Field. We just need to set zip_text to the values of zip and press Apply.</p>
<p><img alt="Calculate Field" src="../img/calc_field.png" /></p>
<p>Now we have what we need to complete the Join. We will right-click on our spatial file and select Joins and Relates &gt; Add Join. Fill out as follows:</p>
<p><img alt="Add Join" src="../img/add_join.png" /></p>
<p>We want to select the Validate option first, so we can see the results of the join, but rememeber we still have to press OK for the join to actually run. Here we see there are 109 zip codes in the tabular data that matched to our zip code spatial file. This makes sense because link nyc kiosks are not in every zip code.</p>
<p><img alt="Validate" src="../img/validate.png" /></p>
<p>After we run the join, we can see our tabular data linked to our spatial data in the attribute table. We could then symbolize by the count field to have a visual representation of how many kiosks are in each zip code.</p>
<p><img alt="Joined Data" src="../img/joined_data.png" /></p>
<p><img alt="Zip Join" src="../img/zip_joined_data.png" /></p>
<h2 id="spatial-joins">Spatial Joins</h2>
<p>We can demonstrate the spatial join process with the unaggregated zip code data. </p>
<p>First we want to convert our kiosk tabular data to a spatial file. Since this data has coordinates we will run the XY to Point tool. Each point is one Link kiosk.</p>
<p><img alt="Points" src="../img/points.png" /></p>
<p>The spatial join will be doing the work of aggregating each point into our zip code polygons, based on the spatial relationship we choose. </p>
<p>Right-click on our zip code spatial file &gt; Joins and Relates &gt; Add Spatial Join. Fill out as follows. </p>
<p><img alt="Spatial Join" src="../img/spatial_join.png" /></p>
<p>In the fields menu, we will see all fields from our point data that are set to be joined on to our zip code data. If we wanted to simplify what our output looks like, we could Remove them.</p>
<p>The critical field for us in this type of spatial join is a default field called Join_Count. This will show a count of all the features that were within that zip code. We could then symbolize by this field and see similar results to our tabular join output.</p>
<p><img alt="Join Complete" src="../img/join_complete.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f13b1293.min.js"></script>
      
    
  </body>
</html>